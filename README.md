# Оптимальный подбор пар "бык–корова" для селекции

Автоматизированный инструмент для отбора оптимальных пар на базе заданных критериев и стратегии.

## Задача

Цель проекта — разработать алгоритм подбора пар "бык–корова" для осеменения, обеспечивающий:
- Максимизацию средней ожидаемой селекционной ценности (EBV) потомства.
- Максимизацию разнообразия EBV (для поддержания генетического разнообразия).
- Соблюдение ограничений по родству (≤ 5%) и по использованию быков (не более 10% коров на одного быка).

---

## Логика алгоритма

### Стратегия

Алгоритм реализован в два этапа:
- Максимизация среднего EBV:
Сначала решается задача целочисленного линейного программирования, где целевая функция — максимизация суммы ожидаемых EBV потомков.
- Максимизация разброса EBV (разнообразие):
Затем, при зафиксированной сумме EBV (найденной на предыдущем этапе), решается вторая задача — максимизация дисперсии EBV, что достигается через максимизацию суммы квадратов ожидаемых EBV.  

Обе задачи решаются с помощью библиотеки `PuLP`.

---

## Реализованные ограничения
Ограничение по родству:
+ Коэффициент родства между быком и коровой должен быть не более 0.05. Рассчитывается рекурсивно на основе родословной (pedigree.csv).
+ Ограничение на использование быков:
Один бык может быть назначен максимум на 10% от общего количества коров.
+ Каждая корова закрепляется за ровно одним быком.

---

## Допущения и упрощения
Ограничение по родству:
+ Коэффициент родства φ(i, j) считается классическим способом, предполагая отсутствие инбридинга `(φ(i, i) = 0.5)`.

+ Пропущенные значения EBV:
    + У быков — восстанавливаются с помощью KNN иммьютации по другим признакам (например, количеству потомков).
    + У коров — заменяются медианным значением EBV среди коров.
+ Не учитываются другие факторы селекции, кроме EBV и родства.

---
## Метрики для оценки результатов
Для оценки качества полученного распределения пар "корова — бык" были использованы следующие метрики:

+ Среднее значение EBV потомков: показывает общий генетический потенциал потомства, который мы стараемся максимизировать на первом этапе оптимизации.

+ Дисперсия и стандартное отклонение EBV потомков: отражают разнообразие в селекционной ценности потомков. Чем выше разброс, тем больше генетическое разнообразие.

+ Минимальный и максимальный EBV потомков: показывают границы ожидаемой селекционной ценности потомства.

+ Количество задействованных быков: важно для понимания, насколько равномерно распределено осеменение и не концентрируется ли оно на отдельных особях.

+ Максимальная загрузка быка (в процентах): проверка соблюдения ограничения: не более 10% коров на одного быка.

+ Распределение нагрузки на быков: для каждого быка рассчитано количество закреплённых за ним коров и процент от общего числа. Это позволяет оценить равномерность распределения и выявить потенциальные узкие места.